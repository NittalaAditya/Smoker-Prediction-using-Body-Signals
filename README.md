# Smoker-Prediction-using-Body-Signals
Given a set of features like hemoglobin, weight, age, and cholesterol, can we predict whether a person can be a smoker or not

# DESCRIPTION

In this project, I investigated a dataset on the body vitals of smoking and non-smoking people that gives an idea of how a person's body structure, like hemoglobin, weight, age, and cholesterol is affected by the perils of smoking. The aim is to find patterns in the dataset between such different factors that will help us classify people as smokers and non-smokers and use this data to devise ways to limit people's smoking habits.[1]
# IMPORTANCE OF THE PROBLEM

Smoking is a worldwide phenomenon and has been the cause of many serious ailments like cancer, heart disease, strokes, etc. Therefore, we were intrigued to pick out factors that can help identify the smoking habits of a person. A lot of the time we look at external factors to predict whether a person may be a smoker or not, be it black lips, yellow mustache, or yellow teeth and nails. But all these factors are only visible at much later stages when it might be too late. Our project aims to look for patterns between the internal vitals of a person and their body structure and come up with inferences that distinguish smokers and non-smokers. We can use these patterns to identify smokers much earlier and provide them with the help that they need to quit smoking. 
Our project can have a substantial social impact since smoking is a global epidemic, with 1.1 billion smokers worldwide. Cigarette smoking is responsible for more than 480,000 deaths yearly in the United States, including more than 41,000 deaths resulting from secondhand smoke exposure. This is about one in five deaths annually, or 1,300 deaths daily[2]. If we can predict smokers at early stages by looking at the patterns discussed in the project, we can get them to help on time and prevent fatal consequences.

# EXPLORATORY ANALYSIS

●	Even though the mean age of men and women seem similar, men tend to start smoking earlier than women
●	High BP comes when the relaxation pressure exceeds 80. We see above that most smokers tend to have high BP pressure. We can assume from the findings that high BP is a smoking indicator and if we do observe that in people, the aim should be to reduce that by meditating, exercising, or eating healthy.
●	A high hemoglobin count occurs most commonly when the body requires an increased oxygen-carrying capacity, usually when a person smokes. The hemoglobin levels of smokers are higher than those of non-smokers thus indicating the above fact.
●	Gtp is an enzyme produced in the liver. With high alcohol or smoking intake, the amount of the enzyme found in the blood increases. The normal levels of Gtp are between 5 and 40. The average Gtp of men smokers is more than these levels. High levels of Gtp indicate the presence of smoking signals.

# SOLUTION
I used two types of classifiers to build the models that will help us predict whether a person is a smoker or not:

# DECISION TREES
I started by using the Chi2 Statistical test to select the ten most important features from the dataset that will be used to train our model. The Gtp, triglyceride, and ALT were the top 3 features of this test. We started by splitting the dataset into training and test data with a 75-25 split. I ran three-fold cross-validation on the training dataset for the decision tree model. The baseline CV(Cross Validation) score with three trees was 73.2%. I then decided to run the model by increasing the max depth of trees as shown in Figure-12 and found that the maximum score of 75.4 was obtained at 29 trees. I used this model on our train and test datasets and found the accuracy percentage on the training dataset to be 99.7%, and 78% on the test dataset indicating signs of overfitting. As a result, I finalized 8 as the max depth which gave us a training accuracy of 76.3% and a test accuracy of 74.4%. Figure-13 shows a snippet of the decision tree. I found that Gender, Gtp, and triglyceride were the three most important features obtained from the model (Figure-14) which was moderately consistent with our initial EDA. HDL, weight, and height were useless and had a very less weightage score. This was quite surprising as height was highly correlated to the smoking variable but in the model, the results were quite opposite.
# RANDOM FOREST
I decided to test our data on a few ensemble methods: bagging and random forest. First, I built a bagging model to see how accurately the model predicted whether an individual was a smoker or not. As seen in Figure-15, the optimal number of trees is less than 100 for the bagging model. The accuracy test on the training set was extremely high at 99%. On the other hand, when we used the testing set on this model, the accuracy score fell to 80.54%. The unusually high training accuracy score along with an approximately 20% lower test accuracy score suggests that there is substantial overfitting in the bagging model. 
Next, I built a random forest model, which is essentially a bagging model but also incorporates random variable subset selection. This model yielded a training accuracy score of 99%, suggesting that this model also is overfitting. When I used the testing set, the accuracy score declined to 82.35%. We can attribute this higher test accuracy score to the random variable subset selection because this subset selection gets rid of the correlation between trees, thus reducing the variance of the trees. I tried to tune the hyperparamters using RandomizedSearchCv but that also improved the accuracy by only a fraction of 0.03 to 82.65%.

# CONCLUSION
Comparing the scores of the models, the best model to predict whether an individual smokes or not is the random forest model. This model produced the best accuracy score of 82.65%. The three most important variables in this model are gender, hemoglobin, and GTP. As mentioned in the exploratory analysis, some studies have suggested that both high GTP and hemoglobin are more likely in smokers versus non-smokers. Our models support this claim, as well as the high correlation between smoking and hemoglobin that was discussed earlier. 
